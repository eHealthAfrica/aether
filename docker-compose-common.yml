# ------------------------------------------------------------------------------
# Aether Common module setup
# ------------------------------------------------------------------------------

version: "2"

services:

  # ---------------------------------
  # use this as a reference in update/build script
  common:
    build:
      context: aether-common-module
      args:
        # Django 2 requirement
        requirements: requirements-django-2.txt
    environment: &common-environment
      TESTING: "true"
    volumes: &common-volumes
      - ./aether-common-module:/code
    command: build
  # ---------------------------------


  # ---------------------------------
  # Django 1.x tests
  common-test-django-1:
    build:
      context: aether-common-module
      args:
        # Django 1 requirement
        requirements: requirements-django-1.txt
    environment: *common-environment
    volumes: *common-volumes
    command: test
  # ---------------------------------


  # ---------------------------------
  # Django 2.x tests
  common-test-django-2:
    build:
      context: aether-common-module
      args:
        # Django 2 requirement
        requirements: requirements-django-2.txt
    environment: *common-environment
    volumes: *common-volumes
    command: test
  # ---------------------------------
