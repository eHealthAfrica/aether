[
  {
    "name": "core",
    "image": "${image_url}",
    "cpu": 1,
    "memory": 256,
    "essential": true,
    "command": ["start"],
    "entryPoint": ["/code/entrypoint.sh"],
    "environment": [
      { "name": "RDS_HOSTNAME", "value": "${database_hostname}"},
      { "name": "RDS_USERNAME", "value": "${database_user}"},
      { "name": "RDS_PASSWORD", "value": "${database_password}"},
      { "name": "RDS_PORT", "value": "${database_port}"},
      { "name": "RDS_DB_NAME", "value": "${database_name}"},
      { "name": "STATIC_ROOT", "value": "/var/www/static"},
      { "name": "DJANGO_USE_X_FORWARDED_PORT", "value": "${django_use_x_forwarded_port}"},
      { "name": "DJANGO_HTTP_X_FORWARDED_PROTO", "value": "${django_http_x_forwarded_proto}"},
      { "name": "DJANGO_USE_X_FORWARDED_HOST", "value": "${django_use_x_forwarded_host}"},
      { "name": "CSRF_COOKIE_DOMAIN", "value": "${domain}"},
      { "name": "CSRF_TRUSTED_ORIGINS", "value": "${domain}"},
      { "name": "SENTRY_DSN", "value": "${sentry_dsn}"},
      { "name": "AWS_KEY", "value": "${aws_key}"},
      { "name": "AWS_SECRET_KEY", "value": "${aws_secret_key}"},
      { "name": "MEDIA_ROOT", "value": "/data"}
    ],
    "mountPoints": [
      {
        "sourceVolume": "static-core",
        "containerPath": "/var/www/static"
      },
      {
        "sourceVolume": "upload-data",
        "containerPath": "/data"
      }
    ]
  },
  {
    "name": "core-nginx",
    "image": "${nginx_image_url}",
    "cpu": 1,
    "memory": 128,
    "essential": true,
    "links": [
      "core"
    ],
    "portMappings": [
      {
        "containerPort": 80
      }
    ],
    "mountPoints": [
      {
        "sourceVolume": "static-core",
        "containerPath": "/var/www/static"
      }
    ]
  }
]
